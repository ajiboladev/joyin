<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=no">
    <title>Chat ‚Ä¢ Joyin</title>
    <link rel="stylesheet" href="./chats.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="icon" type="image/x-icon" href="../joyin-favicon.ico">

    <link rel="manifest" href="../manifest.json">
<meta name="theme-color" content="#5b53f2">
<script src="../pwa-install.js"></script>
</head>
<body>
    <!-- Chat Header -->
    <header class="chat-header">
        <button class="back-btn" onclick="window.history.back()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
        
        <div class="chat-partner-info" onclick="status()" style="cursor: pointer;">
            <div class="avatar-container">
                <img id="partnerAvatar" src="" alt="Avatar" class="avatar">
                <div id="partnerStatus" class="status-indicator"></div>
            </div>
            <div class="user-details">
                <h2 id="partnerName">Loading...</h2>
                <p id="partnerStatusText" class="status-text">Connecting...</p>
            </div>
        </div>
        
        <div id="openBtn" class="header-actions" onclick="openPopup()">
            <button class="icon-btn" id="menuBtn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <circle cx="12" cy="5" r="1" fill="currentColor"/>
                    <circle cx="12" cy="12" r="1" fill="currentColor"/>
                    <circle cx="12" cy="19" r="1" fill="currentColor"/>
                </svg>
            </button>
        </div>
    </header>

    <!-- Chat Messages Container -->
    <main class="messages-container" id="messagesContainer">
        <div class="empty-state" id="emptyState">
            <div class="empty-icon">üí¨</div>
            <h3>No messages yet</h3>
            <p>Send the first message to start the conversation!</p>
        </div>
        <!-- Messages will be inserted here -->
    </main>

    <!-- Message Input Area -->
    <footer class="message-composer">
        <div class="composer-container">
            <div class="input-wrapper">
                <textarea 
                    id="messageInput" 
                    placeholder="Type a message..." 
                    rows="1"
                    maxlength="1000"
                ></textarea>
                <div class="input-actions">
                    <button class="attach-btn" id="attachBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M21.44 11.05L12.25 20.24C11.1242 21.3658 9.59718 22 7.99995 22C6.40272 22 4.87565 21.3658 3.74995 20.24C2.62424 19.1143 1.98999 17.5872 1.98999 15.99C1.98999 14.3928 2.62424 12.8657 3.74995 11.74L12.94 2.55C13.7005 1.78951 14.7185 1.34351 15.78 1.30009C16.8416 1.25668 17.8756 1.61867 18.68 2.31C19.4843 3.00134 20 4.00444 20 5.07C20 6.13557 19.4843 7.13867 18.68 7.83L9.49995 17C9.13216 17.3678 8.63028 17.572 8.10632 17.5679C7.58237 17.5638 7.08452 17.3518 6.72361 16.9778C6.36269 16.6039 6.16918 16.0991 6.18905 15.5752C6.20892 15.0512 6.44044 14.5617 6.82995 14.21L15.07 5.93" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
            </div>
            <button id="sendBtn" class="send-btn" disabled>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                </svg>
            </button>
        </div>
        <p class="typing-indicator" id="typingIndicator"></p>
    </footer>

    <!-- Loading Overlay -->
    <div class="loading-overlay active" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p>Loading conversation...</p>
    </div>

    <!-- Error Modal -->
    <div class="modal-overlay" id="errorModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ö†Ô∏è Error</h3>
                <button class="modal-close" id="closeErrorModal">√ó</button>
            </div>
            <div class="modal-body">
                <p id="errorMessage">Something went wrong. Please try again.</p>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" id="retryButton">Retry</button>
            </div>
        </div>
    </div>


















 <!-- Trigger Button -->
<!-- <button id="openBtn">Open Popup</button> -->

<!-- Popup Overlay -->
<div id="popupOverlay" class="overlay">
  <div class="popup-box">
    <i id="overlayshieldIcon" class="fas fa-shield-halved" style="font-size: 35px; margin-bottom: 4px;"></i>
    <h2 id="overlayh2">Encrypted in transit</h2>
    <p id="overlayp1">Your messages are protected from eavesdropping during transmission, but they are not end-to-end encrypted.</p>
    <p id="overlayp2">We secure your messages while they travel across the internet.</p>
    <button id="closeBtn">Close</button>
  </div>
</div>
<style>
  /* Hidden by default */
.overlay {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(8px); /* Modern blur effect */
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.overlay .popup-box p {
  color: #e4dfdf;
  margin-bottom: 1rem;
  margin-top: 1rem;
}  

.overlay .popup-box #closeBtn {
  background-color: #fff;
  color: #5b53f2;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  margin-top: 1rem;
}

.overlay .popup-box #closeBtn:hover {
  background-color: #f0f0f0;
}


/* Minimalist box style */
.popup-box {
  /* background: rgb(55, 53, 53); */
  background-color: #5b53f2;
  padding: 2rem;
  border-radius: 12px;
  text-align: center;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  max-width: 400px;
  width: 90%;
}

/* Class to show the popup */
.overlay.active {
  display: flex;
}

</style>
<script>
const closeBtn = document.getElementById('closeBtn');
const overlay = document.getElementById('popupOverlay');
const icon = document.getElementById('overlayshieldIcon');

// Select overlay text elements
const h2 = document.getElementById('overlayh2');
const p1 = document.getElementById('overlayp1');
const p2 = document.getElementById('overlayp2');

// Open popup
function openPopup() {
  overlay.classList.add('active');

  // Update icon classes
  icon.classList.add('fa-shield-halved');
  icon.classList.remove('fa-check-circle');

  // Update text content
  h2.textContent = 'Encrypted in transit';
  p1.textContent = 'Your messages are protected from eavesdropping during transmission, but they are not end-to-end encrypted.';
  p2.textContent = 'We secure your messages while they travel across the internet.';
}

// Close popup
closeBtn.onclick = () => {
  overlay.classList.remove('active');
};

// Optional: Close when clicking outside the box
window.onclick = (event) => {
  if (event.target === overlay) {
    overlay.classList.remove('active');
  }
};

// Status popup
function status() {
  overlay.classList.add('active');

  // Update icon classes for status
  icon.classList.remove('fa-shield-halved');
  icon.classList.add('fa-check-circle');

  // Update text content for status
  h2.textContent = 'Active status indicated';
  p1.textContent = 'The green/red dot and online/offline status do not necessarily indicate that your friend is online and available to chat.';
  p2.textContent = '';

  closeBtn.onclick = () => {
  overlay.classList.remove('active');
};
}
</script>














    <script type="module" src="./chat.js" defer></script>
</body>
</html>